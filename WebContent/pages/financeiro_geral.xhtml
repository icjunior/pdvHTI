<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	template="/WEB-INF/template_erp.xhtml">

	<ui:define name="subheader">
        Page Header
    </ui:define>

	<ui:define name="content">
		<ui:include src="/dialog/financeiro_desmembramento.xhtml" />
		<ui:include src="/dialog/financeiro_alteracao_massa.xhtml" />
		<ui:include src="/dialog/financeiro_alteracao.xhtml" />
		<div class="Container100">
			<div class="ContainerIndent">
				<div class="Card ShadowEffect TexAlLeft">
					<h:form id="formFinanceiroGeral">
						<p:growl id="growl" />
						<p:panel id="pnFinanceiroGeral">
							<p:fieldset legend="Filtro" toggleable="true">
								<p:panelGrid id="pgFinanceiroGeral"
									styleClass="ui-panelgrid-blank" style="width:100%">
									<p:row>
										<p:column>
											<h:outputLabel value="Tipo movim.:" />
										</p:column>

										<p:column>
											<h:outputLabel value="Emissão:" />
										</p:column>

										<p:column>
											<h:outputLabel value="Lançamento:" />
										</p:column>

										<p:column>
											<h:outputLabel value="Status:" />
										</p:column>
									</p:row>
									<p:row>
										<p:column>
											<p:selectOneMenu id="tipoMovimentoFinanceiro"
												style="width:125px"
												value="#{financeiroBean.financeiroDTO.tipoMovimentacaoEstoque}">
												<f:selectItem itemLabel="Selecione um"
													noSelectionOption="true" itemDisabled="true" />
												<f:selectItems
													value="#{financeiroBean.tipoMovimentacoesFinanceiro}"
													var="tipoMov" itemValue="#{tipoMov}" itemLabel="#{tipoMov}" />
											</p:selectOneMenu>
										</p:column>

										<p:column>
											<p:calendar value="#{financeiroBean.financeiroDTO.emissao}"
												converter="#{dateConverter}" pattern="dd/MM/yyyy" />
										</p:column>

										<p:column>
											<p:calendar
												value="#{financeiroBean.financeiroDTO.lancamento}"
												pattern="dd/MM/yyyy" converter="#{dateConverter}" />
										</p:column>

										<p:column>
											<p:selectOneMenu id="statusFinanceiro" style="width:125px"
												value="#{financeiroBean.financeiroDTO.statusFinanceiro}">
												<f:selectItem itemLabel="Selecione um"
													noSelectionOption="true" itemDisabled="true" />
												<f:selectItem itemLabel="Todos" itemValue="value"
													value="#{financeiroBean.financeiroDTO.statusFinanceiro}" />
												<f:selectItems value="#{financeiroBean.statusFinanceiro}"
													var="status" itemValue="#{status}" itemLabel="#{status}" />
											</p:selectOneMenu>
										</p:column>
									</p:row>

									<p:row>
										<p:column>
											<h:outputLabel value="NF:" />
										</p:column>
										<p:column>
											<h:outputLabel value="Fornecedor" />
										</p:column>
									</p:row>
									<p:row>
										<p:column>
											<p:inputText />
										</p:column>
										<p:column colspan="2">
											<p:inputText id="inCliente"
												value="#{financeiroBean.financeiroDTO.fornecedor}"
												disabled="true" style="width:80%" />
											<p:spacer width="10" />
											<p:commandButton icon="ui-icon-search"
												id="btnPesquisarCliente"
												actionListener="#{pedidoBean.incluirCliente}">
												<p:ajax event="dialogReturn"
													listener="#{financeiroBean.clienteSelecionado}"
													update="inCliente" />
											</p:commandButton>
										</p:column>
									</p:row>
								</p:panelGrid>
								<br />
								<p:commandButton value="Buscar"
									actionListener="#{financeiroBean.buscar}"
									update="financeiroDT, pgResumoFinanceiro" />
							</p:fieldset>
							<br />
							<p:dataTable emptyMessage="Nenhum registro encontrado"
								id="financeiroDT" value="#{financeiroBean.financeiros}"
								var="financeiro"
								selection="#{financeiroBean.financeirosSelecionados}"
								selectionMode="multiple" rowKey="#{financeiro.codigo}">

								<p:ajax event="rowSelect" update=":formFinanceiroGeral:opcoes" />
								<p:ajax event="rowUnselect" update=":formFinanceiroGeral:opcoes" />

								<p:column headerText="Tipo">
									<h:outputLabel value="#{financeiro.tipoDirecaoFinanceiro}" />
								</p:column>

								<p:column headerText="NF">
									<h:outputLabel value="#{financeiro.notaCabecalho.numero}" />
								</p:column>
								<p:column headerText="Série">
									<h:outputLabel value="#{financeiro.notaCabecalho.serie}" />
								</p:column>
								<p:column headerText="Fornecedor">
									<h:outputLabel value="#{financeiro.notaCabecalho.cliente.nome}" />
								</p:column>
								<p:column headerText="Emissão">
									<h:outputLabel value="#{financeiro.notaCabecalho.emissao.time}">
										<f:convertDateTime pattern="dd/MM/yyyy" />
									</h:outputLabel>
								</p:column>
								<p:column headerText="Lançamento">
									<h:outputLabel
										value="#{financeiro.notaCabecalho.lancamento.time}">
										<f:convertDateTime pattern="dd/MM/yyyy" />
									</h:outputLabel>
								</p:column>
								<p:column headerText="Valor">
									<h:outputLabel value="#{financeiro.valor}">
										<f:convertNumber currencySymbol="R$" type="currency"
											locale="pt_BR" />
									</h:outputLabel>
								</p:column>
								<p:column headerText="Status">
									<h:outputLabel value="#{financeiro.statusPagamentoFinanceiro}" />
								</p:column>
								<p:column headerText="Atribuição">
									<h:outputLabel value="#{financeiro.atribuicao}" />
								</p:column>
							</p:dataTable>
							<br />
							<p:menuButton value="Opções" id="opcoes"
								disabled="#{financeiroBean.financeirosSelecionados.size() lt 1 || financeiroBean.financeirosSelecionados == null}">
								<p:menuitem value="Detalhes"
									disabled="#{financeiroBean.financeirosSelecionados.size() != 1}"
									action="#{financeiroBean.detalhes}" />
								<p:menuitem value="Desmembrar"
									disabled="#{financeiroBean.financeirosSelecionados.size() > 1}"
									onclick="PF('financeiroDesmembramentoDialog').show()"
									update=":formDesmembramentoFinanceiro:financeiroDL" />
								<p:menuitem value="Agrupar"
									disabled="#{financeiroBean.financeirosSelecionados.size() le 1 || financeiroBean.financeirosSelecionados == null}" />
								<p:menuitem value="Gerar arquivo" />
								<p:menuitem value="Excluir"
									actionListener="#{financeiroBean.excluir}" update="growl">
									<p:confirm header="Confirmação"
										message="Deseja realmente excluir os títulos selecionados?"
										icon="pi pi-exclamation-triangle" />
								</p:menuitem>
								<p:menuitem value="Baixar"
									actionListener="#{financeiroBean.baixar}" update="growl"
									id="BaixarTitulo">
									<p:confirm header="Confirmação"
										message="Deseja realmente baixar os títulos selecionados?"
										icon="pi pi-exclamation-triangle" />
								</p:menuitem>
								<p:menuitem value="Editar"
									disabled="#{financeiroBean.financeirosSelecionados.size() > 1}"
									onclick="PF('financeiroEdicaoIndividualDialog').show()"
									update=":formFinanceiroEdicaoIndividual:financeiroEdicaoDL"
									id="btnEditarIndividual" />
								<p:menuitem value="Edição em massa"
									onclick="PF('financeiroEdicaoMassaDialog').show()"
									disabled="#{financeiroBean.financeirosSelecionados.size() le 1 || financeiroBean.financeirosSelecionados == null}"
									id="btnEditarEmMassa" />
								<p:menuitem value="Novo lançamento"
									action="#{financeiroBean.novoLancamento}" />
							</p:menuButton>
							<p:confirmDialog global="true" showEffect="fade"
								hideEffect="fade">
								<p:commandButton value="Sim" type="button"
									styleClass="ui-confirmdialog-yes" icon="pi pi-check" />
								<p:commandButton value="Não" type="button"
									styleClass="ui-confirmdialog-no" icon="pi pi-times" />
							</p:confirmDialog>
							<br />
							<br />
							<p:panel>
								<p:panelGrid id="pgResumoFinanceiro"
									styleClass="ui-panelgrid-blank" style="width:100%">
									<p:row>
										<p:column>
											<h:outputLabel value="Total bruto:" />
										</p:column>
										<p:column>
											<h:outputLabel value="Total líquido:" />
										</p:column>
										<p:column>
											<h:outputLabel value="Registros selecionados:" />
										</p:column>
									</p:row>
									<p:row>
										<p:column>
											<p:inputText readonly="true"
												value="#{financeiroBean.totalBruto}">
												<f:convertNumber currencySymbol="R$" type="currency"
													locale="pt_BR" />
											</p:inputText>
										</p:column>
										<p:column>
											<p:inputText readonly="true"
												value="#{financeiroBean.totalLiquido}">
												<f:convertNumber currencySymbol="R$" type="currency"
													locale="pt_BR" />
											</p:inputText>
										</p:column>
										<p:column>
											<p:inputText readonly="true"
												value="#{financeiroBean.financeiros.size()}" />
										</p:column>
									</p:row>

									<p:row>
										<p:column>
											<h:outputLabel value="Total descontos:" />
										</p:column>
										<p:column>
											<h:outputLabel value="Total acréscimos:" />
										</p:column>
									</p:row>
									<p:row>
										<p:column>
											<p:inputText readonly="true"
												value="#{financeiroBean.totalDescontos}">
												<f:convertNumber currencySymbol="R$" type="currency"
													locale="pt_BR" />
											</p:inputText>
										</p:column>
										<p:column>
											<p:inputText readonly="true"
												value="#{financeiroBean.totalAcrescimos}">
												<f:convertNumber currencySymbol="R$" type="currency"
													locale="pt_BR" />
											</p:inputText>
										</p:column>
									</p:row>
								</p:panelGrid>
							</p:panel>
						</p:panel>
					</h:form>
				</div>
			</div>
		</div>
	</ui:define>
</ui:composition>